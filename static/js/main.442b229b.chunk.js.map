{"version":3,"sources":["Uploader.js","Results.js","App.js","reportWebVitals.js","index.js"],"names":["baseStyle","flex","display","flexDirection","alignItems","padding","borderWidth","borderRadius","borderColor","borderStyle","backgroundColor","color","outline","margin","transition","activeStyle","acceptStyle","rejectStyle","Uploader","props","style","check","className","message","fileDrop","useDropzone","onDrop","acceptedFiles","a","length","file","text","contents","setter","getRootProps","getInputProps","isDragActive","isDragAccept","isDragReject","useMemo","StyledDropzone","fileSetter","IGCParser","require","geolib","listStyle","containerStyle","alignSelf","height","Results","task","JSON","parse","tsk","igc","useState","progress","setProgress","turnpointIndex","turnpoints","circles","positions","preStartPositions","startTime","sss","timeGates","started","i","fixes","fix","turnpoint","moment","time","push","latitude","longitude","getDistance","waypoint","radius","zIndex","description","center","lat","lon","Circle","pathOptions","fillColor","opacity","splice","initialTurn","Math","round","overflow","width","flexGrow","MapContainer","zoom","scrollWheelZoom","TileLayer","attribution","url","Polyline","onMouseMove","event","percentage","screenX","target","offsetLeft","clientWidth","App","setIgc","setTsk","igcUploader","xctskUploader","content","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.442b229b.chunk.js","sourcesContent":["import React, { useMemo } from 'react'\nimport { useDropzone } from 'react-dropzone'\n\nconst baseStyle = {\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    padding: '20px',\n    borderWidth: 2,\n    borderRadius: 2,\n    borderColor: '#eeeeee',\n    borderStyle: 'dashed',\n    backgroundColor: '#fafafa0F',\n    color: '#bdbdbd',\n    outline: 'none',\n    margin: 10,\n    transition: 'border .24s ease-in-out'\n};\n\nconst activeStyle = {\n    borderColor: '#2196f3'\n};\n\nconst acceptStyle = {\n    borderColor: '#00e676'\n};\n\nconst rejectStyle = {\n    borderColor: '#ff1744'\n};\n\nfunction StyledDropzone(props) {\n    const {\n        getRootProps,\n        getInputProps,\n        isDragActive,\n        isDragAccept,\n        isDragReject,\n    } = useDropzone({\n        onDrop: async acceptedFiles => {\n            if(acceptedFiles.length > 0) {\n                const file = acceptedFiles[0];\n                const contents = await file.text();\n                props.setter(contents);\n            }\n        }\n    });\n\n    const style = useMemo(() => ({\n        ...baseStyle,\n        ...(isDragActive ? activeStyle : {}),\n        ...(isDragAccept ? acceptStyle : {}),\n        ...(isDragReject ? rejectStyle : {})\n    }), [\n        isDragActive,\n        isDragReject,\n        isDragAccept\n    ]);\n\n    return (\n        <div className=\"container\">\n            <div {...getRootProps({ style })}>\n                <input {...getInputProps()} />\n                <p>{props.message}</p>\n            </div>\n        </div>\n    );\n}\n\nfunction Uploader(props) {\n    const style = {\n        ...baseStyle,\n        color: \"green\",\n        borderColor: \"green\"\n    };\n    const check = <div className=\"container\" style={style}>\n        <p>{props.message + ' \\u2713'}</p>\n    </div>\n\n    const fileDrop = StyledDropzone({\n        message: props.message,\n        setter: props.fileSetter\n    });\n    \n    if(props.file)\n        return check;\n    return fileDrop;\n}\n\nexport { Uploader };","import { useState } from 'react';\nimport { MapContainer, TileLayer, Circle, Polyline } from 'react-leaflet'\nimport 'leaflet/dist/leaflet.css';\nimport moment from 'moment'\n\n\n\nconst IGCParser = require('igc-parser');\nconst geolib = require('geolib');\n\nconst listStyle = {\n    flex: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    padding: '2px',\n    margin: '2px',\n    borderColor: 'red',\n    color: 'red',\n    borderStyle: 'solid',\n}\n\nconst containerStyle = {\n    display: 'flex',\n    flexDirection: 'row',\n    alignSelf: 'stretch',\n    height: '100vh',\n}\n\nfunction Results(props) {\n    let task = JSON.parse(props.tsk);\n    let igc = IGCParser.parse(props.igc);\n    const [progress, setProgress] = useState(1);\n\n    let turnpointIndex = 0;\n    let turnpoints = [];  // Turnpoints to show\n    let circles = []; // Circles to show on the map\n    let positions = [];\n    let preStartPositions = [];\n\n    // Calculate the starting time (assume SSS)\n    const startTime = task.sss.timeGates[0];\n\n    let started = false;\n    for( let i = 0; i < igc.fixes.length &&  i / igc.fixes.length < progress; i++) {\n        const fix = igc.fixes[i];\n        const turnpoint = task.turnpoints[turnpointIndex];\n\n        // We're before the start of the race.  Do not consider this.\n        if(!started && moment(\"1970-01-01 \" + fix.time + \"Z\") < moment(\"1970-01-01 \" + startTime)) {\n            preStartPositions.push([fix.latitude, fix.longitude]);\n            continue;\n        } else {\n            started = true;\n            positions.push([fix.latitude, fix.longitude]);\n        }\n\n        if (turnpoint == null) {\n            continue;\n        }\n        const distance = geolib.getDistance(fix, turnpoint.waypoint);\n        if (distance < turnpoint.radius) {\n            // We have hit a turnpoint, add it to a success list and move on\n            turnpoints.push(\n                <div key={\"turnpoint-\" + turnpointIndex} style={{\n                    ...listStyle,\n                    color: 'green',\n                    borderColor: 'green',\n                    zIndex: i\n                }}\n                >\n                    <small>{turnpoint.waypoint.description}</small>\n                </div>\n            );\n            let center = [turnpoint.waypoint.lat, turnpoint.waypoint.lon];\n            circles.push(<Circle center={center} pathOptions={{ fillColor: 'blue', color: 'transparent', opacity: 0.25 }} radius={turnpoint.radius} key={\"turnpoint-circle-\" + turnpointIndex} />);\n            turnpointIndex++;\n        }\n    }\n\n    // Complete filling in all the waypoints we didn't get.\n    for (let i = task.turnpoints.length - 1; i >= turnpointIndex; i--) {\n        // Show red for everything except for the next waypoint we're trying to hit\n        let color = \"gray\"\n        let fillColor = \"FFF\"\n        let opacity = 0.25\n        if(i === turnpointIndex) {\n            color = \"orange\"\n            fillColor = \"orange\"\n            opacity = 1\n        }\n\n        const turnpoint = task.turnpoints[i];\n        turnpoints.splice(turnpointIndex, 0, <div key={\"turnpoint-\" + i} style={{...listStyle, borderColor: color, zIndex: i}}>\n            <small>{turnpoint.waypoint.description}</small>\n        </div>);\n        let center = [turnpoint.waypoint.lat, turnpoint.waypoint.lon];\n\n        circles.push(<Circle center={center} pathOptions={{ color: color, fillColor: fillColor, opacity: opacity }} radius={turnpoint.radius} key={\"turnpoint-circle-\" + i} />)\n    };\n\n    const initialTurn = task.turnpoints[0];\n    const center = [initialTurn.waypoint.lat, initialTurn.waypoint.lon]\n    const time = igc.fixes[Math.round(igc.fixes.length * progress - 1)]?.time ?? \"Nan\";\n\n    return <div style={containerStyle}>\n        <div style={{ display: 'flex', flexDirection: 'column', overflow: 'auto' }}>\n            <h2>All turnpoints</h2>\n            {turnpoints}\n        </div>\n        <div className=\"rightHandContainer\" style={{ alignSelf: 'stretch', width: \"100%\", display: 'flex', flexDirection: 'column', height: \"100vh\" }}>\n            <div className=\"mapContainer\" style={{ flexGrow: 1, display: 'flex' }}>\n                <MapContainer center={center} zoom={13} scrollWheelZoom={false}>\n                <TileLayer\n        attribution='&copy; <a href=\"https://stadiamaps.com/\">Stadia Maps</a>, &copy; <a href=\"https://openmaptiles.org/\">OpenMapTiles</a> &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors'\n        url=\"https://{s}.tile.jawg.io/jawg-terrain/{z}/{x}/{y}{r}.png?access-token=OCSVqPtVG4tEq4zlKGa0sA3LW6bC5l528PJhTuBSPZ5BPvbjemWIyzaHd15iYV11\"\n      />                    {circles}\n                    <Polyline positions={preStartPositions} color=\"gray\" />\n                    <Polyline positions={positions} />\n                </MapContainer>\n\n            </div>\n            <div className=\"flightProgress\" style={{ height: \"80px\", backgroundColor: \"blue\" }} onMouseMove={(event) => {\n                let percentage = (event.screenX - event.target.offsetLeft) / event.target.clientWidth;\n                setProgress(percentage)\n            }}>\n                <p>{time}</p>\n            </div>\n        </div>\n    </div>\n}\n\nexport { Results }\n\n\n","import './App.css';\nimport { Uploader } from './Uploader.js';\nimport { useState } from 'react';\nimport { Results } from './Results.js';\n\n\nconst style = {\n  display: 'flex',\n  flexDirection: 'row',\n  alignItems: 'center',\n}\n\nfunction App() {\n  // State for IGC and XCTSK uploads\n  const [igc, setIgc] = useState();\n  const [tsk, setTsk] = useState();\n\n  // Uploader views\n  const igcUploader = Uploader({\n    message: \"Upload igc file\",\n    file: igc,\n    fileSetter: setIgc,\n  });\n  const xctskUploader = Uploader({\n    message: \"Upload xctsk\",\n    file: tsk,\n    fileSetter: setTsk\n  });\n\n  // Component for uploading the files\n  let content = <div style={style}>\n    {igcUploader}\n    {xctskUploader}\n  </div>;\n\n  // Component for showing the results given the files\n  if (tsk != null && igc != null) {\n    content = <Results tsk={tsk} igc={igc} />;\n  }\n\n  return (\n\n    <div className=\"App\">\n      <header className=\"App-header\">\n        {content}\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}